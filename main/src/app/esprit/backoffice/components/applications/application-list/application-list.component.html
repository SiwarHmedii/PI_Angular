<div class="application-list-container">
  <div class="header">
    <h2>Job Applications</h2>
  </div>
  

  
  <div class="loading-spinner" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Loading applications...</p>
  </div>
  
  <div class="filters-container" *ngIf="!isLoading">
    <div class="filters">
      <input 
        type="text" 
        placeholder="Search by Student ID or Offer Title" 
        [(ngModel)]="searchText" 
        (input)="filterApplications()" />
      
      <!-- Only show if userCompany not set -->
      <select 
        *ngIf="!userCompany" 
        [(ngModel)]="selectedCompany" 
        (change)="filterApplications()">
        <option [ngValue]="null">All Companies</option>
        <option *ngFor="let name of companies" [ngValue]="name">{{ name }}</option>
      </select>
      
      <select 
        [(ngModel)]="selectedOfferId" 
        (change)="filterApplications()">
        <option [ngValue]="null">All Offers</option>
        <option *ngFor="let offer of offers" [ngValue]="offer.id">{{ offer.title }}</option>
      </select>
      
      <div class="date-filters">
        <label>
          Date From
          <input type="date" [(ngModel)]="dateFrom" (change)="filterApplications()" />
        </label>
        
        <label>
          Date To
          <input type="date" [(ngModel)]="dateTo" (change)="filterApplications()" />
        </label>
      </div>
    </div>
  </div>
  
  <div class="applications-list" *ngIf="filteredApplications.length; else noApps">
    <div class="application-card" *ngFor="let app of filteredApplications">
      <div class="application-header">
        <h3>{{ app.offer?.title || 'Unnamed Offer' }}</h3>
        <div class="student-id">ID Student: {{ app.studentId }}</div>
      </div>
      
      <div class="application-meta">
        <span class="company">{{ app.offer?.company || 'N/A' }}</span>
        <span class="quiz-score" 
          [ngClass]="{
            'low': app.quizScore < 40, 
            'medium': app.quizScore >= 40 && app.quizScore < 70
          }">
          Quiz: {{ app.quizScore ?? 'N/A' }}
        </span>
      </div>
      
      <div class="application-details">
        <div class="detail-row">
          <strong>Applied:</strong> <span>{{ app.appliedAt | date:'medium' }}</span>
        </div>
        <!-- <div class="detail-row" *ngIf="app.statusUpdatedAt">
          <strong>Status:</strong> <span>{{ app.status || 'Pending' }}</span>
        </div>
        <div class="detail-row" *ngIf="app.interviewDate">
          <strong>Interview:</strong> <span>{{ app.interviewDate | date:'short' }}</span>
        </div> -->
      </div>
      
      <div class="application-actions">
        <button class="btn-link" (click)="viewDetails(app)">View Details</button>
        <button class="btn-link" (click)="updateStatus(app)">Update Status</button>
      </div>
    </div>
  </div>
  
  <ng-template #noApps>
    <div class="empty-state">
      <p>No applications match your search criteria.</p>
    </div>
  </ng-template>
</div>