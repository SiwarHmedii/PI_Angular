<div class="quiz-management-container">
    <h2>Create Quiz for Job Offer</h2>
  
    <div *ngIf="isLoading" class="loading">
      <p>Loading...</p>
    </div>
  
    <div *ngIf="!isLoading">
      <form [formGroup]="quizForm" (ngSubmit)="updateQuiz()">
        
        <!-- Quiz Title -->
        <div class="quiz-header">
          <div class="form-group">
            <label for="title">Quiz Title:</label>
            <input type="text" id="title" formControlName="title" class="form-control">
            <div *ngIf="quizForm.get('title')?.invalid && quizForm.get('title')?.touched" class="error-message">
              Quiz title is required
            </div>
          </div>
        </div>
  
        <!-- Questions List -->
        <div formArrayName="questions" class="questions-section mt-4">
          <h3>Questions</h3>
  
          <button type="button" (click)="addQuestion()" class="btn btn-outline-primary mb-3">
            + Add Question
          </button>
  
          <!-- Each Question -->
          <div 
            *ngFor="let question of questions.controls; let i = index" 
            [formGroupName]="i" 
            class="question-form mb-4 p-3 border rounded"
          >
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h4>Question {{ i + 1 }}</h4>
              <button 
                type="button" 
                (click)="removeQuestion(i)" 
                class="btn btn-danger btn-sm"
                *ngIf="questions.length > 1">
                Remove Question
              </button>
            </div>
  
            <!-- Question Content -->
            <div class="form-group">
              <label [for]="'questionContent' + i">Question Content:</label>
              <textarea 
                [id]="'questionContent' + i"
                formControlName="content" 
                class="form-control" 
                rows="3" 
                placeholder="Enter question content"
              ></textarea>
              <div *ngIf="question.get('content')?.invalid && question.get('content')?.touched" class="error-message">
                Question content is required
              </div>
            </div>
  
            <!-- Answers Section -->
            <div class="answers-section mt-3" formArrayName="answers">
              <h5>Answers</h5>
  
              <!-- Each Answer -->
              <div 
                *ngFor="let answer of getAnswers(i).controls; let j = index" 
                [formGroupName]="j" 
                class="answer-form mb-2 d-flex align-items-center gap-2"
              >
                <input 
                  type="text" 
                  formControlName="content" 
                  class="form-control" 
                  placeholder="Answer option"
                >
                <div class="form-check">
                  <input 
                    type="checkbox" 
                    formControlName="correct" 
                    class="form-check-input" 
                    [id]="'correct' + i + '_' + j"
                  >
                  <label 
                    class="form-check-label" 
                    [for]="'correct' + i + '_' + j"
                  >Correct</label>
                </div>
                <button 
                  type="button" 
                  class="btn btn-outline-danger btn-sm" 
                  (click)="removeAnswer(i, j)"
                  *ngIf="getAnswers(i).length > 1"
                >âœ•</button>
              </div>
  
              <!-- Add Answer Button -->
              <button 
                type="button" 
                class="btn btn-outline-success btn-sm mt-2"
                (click)="addAnswerToQuestion(questions.at(i))"
              >+ Add Answer Option</button>
            </div>
          </div>
        </div>
  
        <!-- Submit Button -->
        <div class="form-actions mt-4">
          <button 
            type="submit" 
            class="btn btn-primary save-btn" 
            [disabled]="isSubmitting || quizForm.invalid"
          >
            {{ isSubmitting ? 'Updating...' : 'Update Quiz' }}
          </button>
        </div>
      </form>
    </div>
  </div>
  